{"tool": {"driver": {"name": "PHP Security Audit", "rules": [{"id": "ArgumentTypeCoercion", "help": {"text": "Argument 1 of mysqli_real_escape_string expects mysqli, parent type object provided.", "markdown": "Argument 1 of mysqli_real_escape_string expects mysqli, parent type object provided."}, "name": "Argument 1 of mysqli real escape string expects mysqli, parent type object provided", "properties": {"tags": ["Scan"], "precision": "high"}, "defaultConfiguration": {"level": "warning"}, "fullDescription": {"text": "Argument 1 of mysqli_real_escape_string expects mysqli, parent type object provided."}, "helpUri": "https://psalm.dev/193", "shortDescription": {"text": "Argument 1 of mysqli_real_escape_string expects mysqli, parent type object provided."}}, {"id": "TypeDoesNotContainNull", "help": {"text": "Cannot resolve types for $___mysqli_res - bool does not contain null.", "markdown": "Cannot resolve types for $___mysqli_res - bool does not contain null."}, "name": "Cannot resolve types for $   mysqli res - bool does not contain null", "properties": {"tags": ["Scan"], "precision": "high"}, "defaultConfiguration": {"level": "warning"}, "fullDescription": {"text": "Cannot resolve types for $___mysqli_res - bool does not contain null."}, "helpUri": "https://psalm.dev/090", "shortDescription": {"text": "Cannot resolve types for $___mysqli_res - bool does not contain null."}}, {"id": "ForbiddenCode", "help": {"text": "Unsafe shell_exec.", "markdown": "Unsafe shell_exec."}, "name": "Unsafe shell exec", "properties": {"tags": ["Scan"], "precision": "high"}, "defaultConfiguration": {"level": "warning"}, "fullDescription": {"text": "Unsafe shell_exec."}, "helpUri": "https://psalm.dev/002", "shortDescription": {"text": "Unsafe shell_exec."}}], "version": "1.0.0-scan", "fullName": "PHP Security Audit"}}, "conversion": {"tool": {"driver": {"name": "@ShiftLeft/sast-scan"}}, "invocation": {"arguments": ["psalm", "--report-show-info=false", "--show-snippet=true", "--find-dead-code=always", "--find-unused-code=always", "-m", "--no-progress", "--no-file-cache", "--no-suggestions", "--no-cache", "--root=/github/workspace", "--report=reports/audit-php-report.json"], "executionSuccessful": true, "commandLine": "psalm --report-show-info=false --show-snippet=true --find-dead-code=always --find-unused-code=always -m --no-progress --no-file-cache --no-suggestions --no-cache --root=/github/workspace --report=reports/audit-php-report.json", "endTimeUtc": "2021-11-17T00:36:43Z", "workingDirectory": {"uri": "file:///github/workspace"}}}, "invocations": [{"executionSuccessful": true, "endTimeUtc": "2021-11-17T00:36:43Z", "workingDirectory": {"uri": "file:///github/workspace"}}], "properties": {"metrics": {"total": 63, "critical": 0, "high": 0, "medium": 63, "low": 0}}, "results": [{"message": {"markdown": "", "text": "Argument 1 of mysqli_real_escape_string expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$user = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $user ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n"}, "startLine": 10}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/brute/source/high.php"}, "contextRegion": {"snippet": {"text": "\t$user = stripslashes( $user );\n\t$user = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $user ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n\n\t// Sanitise password input\n"}, "endLine": 12, "startLine": 9}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "089ac82c09be71df", "scanFileHash": "ba9c9fbd50b6420e"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_real_escape_string expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$pass = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $pass ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n"}, "startLine": 15}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/brute/source/high.php"}, "contextRegion": {"snippet": {"text": "\t$pass = stripslashes( $pass );\n\t$pass = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $pass ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n\t$pass = md5( $pass );\n\n"}, "endLine": 17, "startLine": 14}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "e21f4c59a0eec5e5", "scanFileHash": "ba9c9fbd50b6420e"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_error expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$result = mysqli_query($GLOBALS[\"___mysqli_ston\"],  $query ) or die( '<pre>' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );\n"}, "startLine": 20}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/brute/source/high.php"}, "contextRegion": {"snippet": {"text": "\t$query  = \"SELECT * FROM `users` WHERE user = '$user' AND password = '$pass';\";\n\t$result = mysqli_query($GLOBALS[\"___mysqli_ston\"],  $query ) or die( '<pre>' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );\n\n\tif( $result && mysqli_num_rows( $result ) == 1 ) {\n"}, "endLine": 22, "startLine": 19}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "97831a3e1dfedafc", "scanFileHash": "ba9c9fbd50b6420e"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Cannot resolve types for $___mysqli_res - bool does not contain null."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t((is_null($___mysqli_res = mysqli_close($GLOBALS[\"___mysqli_ston\"]))) ? false : $___mysqli_res);\n"}, "startLine": 37}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/brute/source/high.php"}, "contextRegion": {"snippet": {"text": "\n\t((is_null($___mysqli_res = mysqli_close($GLOBALS[\"___mysqli_ston\"]))) ? false : $___mysqli_res);\n}\n\n"}, "endLine": 39, "startLine": 36}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "a4888879b9d45856", "scanFileHash": "ba9c9fbd50b6420e"}, "ruleId": "TypeDoesNotContainNull", "ruleIndex": 1}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_real_escape_string expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$user = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $user ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n"}, "startLine": 10}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/brute/source/impossible.php"}, "contextRegion": {"snippet": {"text": "\t$user = stripslashes( $user );\n\t$user = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $user ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n\n\t// Sanitise password input\n"}, "endLine": 12, "startLine": 9}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "089ac82c09be71df", "scanFileHash": "3bd2e87fcdbacb69"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_real_escape_string expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$pass = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $pass ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n"}, "startLine": 15}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/brute/source/impossible.php"}, "contextRegion": {"snippet": {"text": "\t$pass = stripslashes( $pass );\n\t$pass = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $pass ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n\t$pass = md5( $pass );\n\n"}, "endLine": 17, "startLine": 14}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "e21f4c59a0eec5e5", "scanFileHash": "3bd2e87fcdbacb69"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_error expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$result = mysqli_query($GLOBALS[\"___mysqli_ston\"],  $query ) or die( '<pre>' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );\n"}, "startLine": 13}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/brute/source/low.php"}, "contextRegion": {"snippet": {"text": "\t$query  = \"SELECT * FROM `users` WHERE user = '$user' AND password = '$pass';\";\n\t$result = mysqli_query($GLOBALS[\"___mysqli_ston\"],  $query ) or die( '<pre>' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );\n\n\tif( $result && mysqli_num_rows( $result ) == 1 ) {\n"}, "endLine": 15, "startLine": 12}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "97831a3e1dfedafc", "scanFileHash": "f36da3753611a347"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Cannot resolve types for $___mysqli_res - bool does not contain null."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t((is_null($___mysqli_res = mysqli_close($GLOBALS[\"___mysqli_ston\"]))) ? false : $___mysqli_res);\n"}, "startLine": 29}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/brute/source/low.php"}, "contextRegion": {"snippet": {"text": "\n\t((is_null($___mysqli_res = mysqli_close($GLOBALS[\"___mysqli_ston\"]))) ? false : $___mysqli_res);\n}\n\n"}, "endLine": 31, "startLine": 28}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "a4888879b9d45856", "scanFileHash": "f36da3753611a347"}, "ruleId": "TypeDoesNotContainNull", "ruleIndex": 1}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_real_escape_string expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$user = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $user ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n"}, "startLine": 6}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/brute/source/medium.php"}, "contextRegion": {"snippet": {"text": "\t$user = $_GET[ 'username' ];\n\t$user = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $user ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n\n\t// Sanitise password input\n"}, "endLine": 8, "startLine": 5}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "089ac82c09be71df", "scanFileHash": "6138a63240f95eab"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_real_escape_string expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$pass = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $pass ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n"}, "startLine": 10}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/brute/source/medium.php"}, "contextRegion": {"snippet": {"text": "\t$pass = $_GET[ 'password' ];\n\t$pass = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $pass ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n\t$pass = md5( $pass );\n\n"}, "endLine": 12, "startLine": 9}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "e21f4c59a0eec5e5", "scanFileHash": "6138a63240f95eab"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_error expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$result = mysqli_query($GLOBALS[\"___mysqli_ston\"],  $query ) or die( '<pre>' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );\n"}, "startLine": 15}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/brute/source/medium.php"}, "contextRegion": {"snippet": {"text": "\t$query  = \"SELECT * FROM `users` WHERE user = '$user' AND password = '$pass';\";\n\t$result = mysqli_query($GLOBALS[\"___mysqli_ston\"],  $query ) or die( '<pre>' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );\n\n\tif( $result && mysqli_num_rows( $result ) == 1 ) {\n"}, "endLine": 17, "startLine": 14}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "97831a3e1dfedafc", "scanFileHash": "6138a63240f95eab"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Cannot resolve types for $___mysqli_res - bool does not contain null."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t((is_null($___mysqli_res = mysqli_close($GLOBALS[\"___mysqli_ston\"]))) ? false : $___mysqli_res);\n"}, "startLine": 32}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/brute/source/medium.php"}, "contextRegion": {"snippet": {"text": "\n\t((is_null($___mysqli_res = mysqli_close($GLOBALS[\"___mysqli_ston\"]))) ? false : $___mysqli_res);\n}\n\n"}, "endLine": 34, "startLine": 31}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "a4888879b9d45856", "scanFileHash": "6138a63240f95eab"}, "ruleId": "TypeDoesNotContainNull", "ruleIndex": 1}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_real_escape_string expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t\t\t$pass_new = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $pass_new ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n"}, "startLine": 26}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/captcha/source/high.php"}, "contextRegion": {"snippet": {"text": "\t\tif ($pass_new == $pass_conf) {\n\t\t\t$pass_new = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $pass_new ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n\t\t\t$pass_new = md5( $pass_new );\n\n"}, "endLine": 28, "startLine": 25}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "f0533a39fa3fe706", "scanFileHash": "6de0718974b76024"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_error expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t\t\t$result = mysqli_query($GLOBALS[\"___mysqli_ston\"],  $insert ) or die( '<pre>' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );\n"}, "startLine": 31}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/captcha/source/high.php"}, "contextRegion": {"snippet": {"text": "\t\t\t$insert = \"UPDATE `users` SET password = '$pass_new' WHERE user = '\" . dvwaCurrentUser() . \"' LIMIT 1;\";\n\t\t\t$result = mysqli_query($GLOBALS[\"___mysqli_ston\"],  $insert ) or die( '<pre>' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );\n\n\t\t\t// Feedback for user\n"}, "endLine": 33, "startLine": 30}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "4bb91b52ef1c89af", "scanFileHash": "6de0718974b76024"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Cannot resolve types for $___mysqli_res - bool does not contain null."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t((is_null($___mysqli_res = mysqli_close($GLOBALS[\"___mysqli_ston\"]))) ? false : $___mysqli_res);\n"}, "startLine": 49}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/captcha/source/high.php"}, "contextRegion": {"snippet": {"text": "\n\t((is_null($___mysqli_res = mysqli_close($GLOBALS[\"___mysqli_ston\"]))) ? false : $___mysqli_res);\n}\n\n"}, "endLine": 51, "startLine": 48}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "a4888879b9d45856", "scanFileHash": "6de0718974b76024"}, "ruleId": "TypeDoesNotContainNull", "ruleIndex": 1}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_real_escape_string expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$pass_new  = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $pass_new ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n"}, "startLine": 13}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/captcha/source/impossible.php"}, "contextRegion": {"snippet": {"text": "\t$pass_new  = stripslashes( $pass_new );\n\t$pass_new  = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $pass_new ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n\t$pass_new  = md5( $pass_new );\n\n"}, "endLine": 15, "startLine": 12}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "f0ff5d8fc9242ac7", "scanFileHash": "1947cc0758d199c9"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_real_escape_string expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$pass_conf = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $pass_conf ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n"}, "startLine": 18}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/captcha/source/impossible.php"}, "contextRegion": {"snippet": {"text": "\t$pass_conf = stripslashes( $pass_conf );\n\t$pass_conf = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $pass_conf ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n\t$pass_conf = md5( $pass_conf );\n\n"}, "endLine": 20, "startLine": 17}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "602470a212952c0a", "scanFileHash": "1947cc0758d199c9"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_real_escape_string expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$pass_curr = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $pass_curr ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n"}, "startLine": 23}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/captcha/source/impossible.php"}, "contextRegion": {"snippet": {"text": "\t$pass_curr = stripslashes( $pass_curr );\n\t$pass_curr = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $pass_curr ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n\t$pass_curr = md5( $pass_curr );\n\n"}, "endLine": 25, "startLine": 22}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "90489f0fcca07e59", "scanFileHash": "1947cc0758d199c9"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_real_escape_string expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t\t$pass_new = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $pass_new ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n"}, "startLine": 56}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/captcha/source/low.php"}, "contextRegion": {"snippet": {"text": "\t\t// They do!\n\t\t$pass_new = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $pass_new ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n\t\t$pass_new = md5( $pass_new );\n\n"}, "endLine": 58, "startLine": 55}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "f0533a39fa3fe706", "scanFileHash": "d93f17b385337ca7"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_error expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t\t$result = mysqli_query($GLOBALS[\"___mysqli_ston\"],  $insert ) or die( '<pre>' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );\n"}, "startLine": 61}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/captcha/source/low.php"}, "contextRegion": {"snippet": {"text": "\t\t$insert = \"UPDATE `users` SET password = '$pass_new' WHERE user = '\" . dvwaCurrentUser() . \"';\";\n\t\t$result = mysqli_query($GLOBALS[\"___mysqli_ston\"],  $insert ) or die( '<pre>' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );\n\n\t\t// Feedback for the end user\n"}, "endLine": 63, "startLine": 60}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "4bb91b52ef1c89af", "scanFileHash": "d93f17b385337ca7"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Cannot resolve types for $___mysqli_res - bool does not contain null."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t((is_null($___mysqli_res = mysqli_close($GLOBALS[\"___mysqli_ston\"]))) ? false : $___mysqli_res);\n"}, "startLine": 72}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/captcha/source/low.php"}, "contextRegion": {"snippet": {"text": "\n\t((is_null($___mysqli_res = mysqli_close($GLOBALS[\"___mysqli_ston\"]))) ? false : $___mysqli_res);\n}\n\n"}, "endLine": 74, "startLine": 71}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "a4888879b9d45856", "scanFileHash": "d93f17b385337ca7"}, "ruleId": "TypeDoesNotContainNull", "ruleIndex": 1}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_real_escape_string expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t\t$pass_new = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $pass_new ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n"}, "startLine": 64}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/captcha/source/medium.php"}, "contextRegion": {"snippet": {"text": "\t\t// They do!\n\t\t$pass_new = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $pass_new ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n\t\t$pass_new = md5( $pass_new );\n\n"}, "endLine": 66, "startLine": 63}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "f0533a39fa3fe706", "scanFileHash": "c9e1e4546d71adf0"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_error expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t\t$result = mysqli_query($GLOBALS[\"___mysqli_ston\"],  $insert ) or die( '<pre>' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );\n"}, "startLine": 69}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/captcha/source/medium.php"}, "contextRegion": {"snippet": {"text": "\t\t$insert = \"UPDATE `users` SET password = '$pass_new' WHERE user = '\" . dvwaCurrentUser() . \"';\";\n\t\t$result = mysqli_query($GLOBALS[\"___mysqli_ston\"],  $insert ) or die( '<pre>' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );\n\n\t\t// Feedback for the end user\n"}, "endLine": 71, "startLine": 68}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "4bb91b52ef1c89af", "scanFileHash": "c9e1e4546d71adf0"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Cannot resolve types for $___mysqli_res - bool does not contain null."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t((is_null($___mysqli_res = mysqli_close($GLOBALS[\"___mysqli_ston\"]))) ? false : $___mysqli_res);\n"}, "startLine": 80}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/captcha/source/medium.php"}, "contextRegion": {"snippet": {"text": "\n\t((is_null($___mysqli_res = mysqli_close($GLOBALS[\"___mysqli_ston\"]))) ? false : $___mysqli_res);\n}\n\n"}, "endLine": 82, "startLine": 79}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "a4888879b9d45856", "scanFileHash": "c9e1e4546d71adf0"}, "ruleId": "TypeDoesNotContainNull", "ruleIndex": 1}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_real_escape_string expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t\t$pass_new = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $pass_new ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n"}, "startLine": 14}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/csrf/source/high.php"}, "contextRegion": {"snippet": {"text": "\t\t// They do!\n\t\t$pass_new = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $pass_new ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n\t\t$pass_new = md5( $pass_new );\n\n"}, "endLine": 16, "startLine": 13}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "f0533a39fa3fe706", "scanFileHash": "615c3e0a7b0cc27d"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_error expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t\t$result = mysqli_query($GLOBALS[\"___mysqli_ston\"],  $insert ) or die( '<pre>' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );\n"}, "startLine": 19}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/csrf/source/high.php"}, "contextRegion": {"snippet": {"text": "\t\t$insert = \"UPDATE `users` SET password = '$pass_new' WHERE user = '\" . dvwaCurrentUser() . \"';\";\n\t\t$result = mysqli_query($GLOBALS[\"___mysqli_ston\"],  $insert ) or die( '<pre>' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );\n\n\t\t// Feedback for the user\n"}, "endLine": 21, "startLine": 18}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "4bb91b52ef1c89af", "scanFileHash": "615c3e0a7b0cc27d"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Cannot resolve types for $___mysqli_res - bool does not contain null."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t((is_null($___mysqli_res = mysqli_close($GLOBALS[\"___mysqli_ston\"]))) ? false : $___mysqli_res);\n"}, "startLine": 29}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/csrf/source/high.php"}, "contextRegion": {"snippet": {"text": "\n\t((is_null($___mysqli_res = mysqli_close($GLOBALS[\"___mysqli_ston\"]))) ? false : $___mysqli_res);\n}\n\n"}, "endLine": 31, "startLine": 28}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "a4888879b9d45856", "scanFileHash": "615c3e0a7b0cc27d"}, "ruleId": "TypeDoesNotContainNull", "ruleIndex": 1}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_real_escape_string expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$pass_curr = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $pass_curr ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n"}, "startLine": 14}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/csrf/source/impossible.php"}, "contextRegion": {"snippet": {"text": "\t$pass_curr = stripslashes( $pass_curr );\n\t$pass_curr = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $pass_curr ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n\t$pass_curr = md5( $pass_curr );\n\n"}, "endLine": 16, "startLine": 13}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "90489f0fcca07e59", "scanFileHash": "23babb4159539c35"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_real_escape_string expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t\t$pass_new = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $pass_new ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n"}, "startLine": 27}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/csrf/source/impossible.php"}, "contextRegion": {"snippet": {"text": "\t\t$pass_new = stripslashes( $pass_new );\n\t\t$pass_new = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $pass_new ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n\t\t$pass_new = md5( $pass_new );\n\n"}, "endLine": 29, "startLine": 26}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "f0533a39fa3fe706", "scanFileHash": "23babb4159539c35"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_real_escape_string expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t\t$pass_new = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $pass_new ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n"}, "startLine": 11}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/csrf/source/low.php"}, "contextRegion": {"snippet": {"text": "\t\t// They do!\n\t\t$pass_new = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $pass_new ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n\t\t$pass_new = md5( $pass_new );\n\n"}, "endLine": 13, "startLine": 10}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "f0533a39fa3fe706", "scanFileHash": "ef3df7d3f230761d"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_error expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t\t$result = mysqli_query($GLOBALS[\"___mysqli_ston\"],  $insert ) or die( '<pre>' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );\n"}, "startLine": 16}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/csrf/source/low.php"}, "contextRegion": {"snippet": {"text": "\t\t$insert = \"UPDATE `users` SET password = '$pass_new' WHERE user = '\" . dvwaCurrentUser() . \"';\";\n\t\t$result = mysqli_query($GLOBALS[\"___mysqli_ston\"],  $insert ) or die( '<pre>' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );\n\n\t\t// Feedback for the user\n"}, "endLine": 18, "startLine": 15}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "4bb91b52ef1c89af", "scanFileHash": "ef3df7d3f230761d"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Cannot resolve types for $___mysqli_res - bool does not contain null."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t((is_null($___mysqli_res = mysqli_close($GLOBALS[\"___mysqli_ston\"]))) ? false : $___mysqli_res);\n"}, "startLine": 26}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/csrf/source/low.php"}, "contextRegion": {"snippet": {"text": "\n\t((is_null($___mysqli_res = mysqli_close($GLOBALS[\"___mysqli_ston\"]))) ? false : $___mysqli_res);\n}\n\n"}, "endLine": 28, "startLine": 25}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "a4888879b9d45856", "scanFileHash": "ef3df7d3f230761d"}, "ruleId": "TypeDoesNotContainNull", "ruleIndex": 1}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_real_escape_string expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t\t\t$pass_new = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $pass_new ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n"}, "startLine": 13}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/csrf/source/medium.php"}, "contextRegion": {"snippet": {"text": "\t\t\t// They do!\n\t\t\t$pass_new = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $pass_new ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n\t\t\t$pass_new = md5( $pass_new );\n\n"}, "endLine": 15, "startLine": 12}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "f0533a39fa3fe706", "scanFileHash": "3797bc11bef2af6e"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_error expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t\t\t$result = mysqli_query($GLOBALS[\"___mysqli_ston\"],  $insert ) or die( '<pre>' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );\n"}, "startLine": 18}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/csrf/source/medium.php"}, "contextRegion": {"snippet": {"text": "\t\t\t$insert = \"UPDATE `users` SET password = '$pass_new' WHERE user = '\" . dvwaCurrentUser() . \"';\";\n\t\t\t$result = mysqli_query($GLOBALS[\"___mysqli_ston\"],  $insert ) or die( '<pre>' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );\n\n\t\t\t// Feedback for the user\n"}, "endLine": 20, "startLine": 17}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "4bb91b52ef1c89af", "scanFileHash": "3797bc11bef2af6e"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Cannot resolve types for $___mysqli_res - bool does not contain null."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t((is_null($___mysqli_res = mysqli_close($GLOBALS[\"___mysqli_ston\"]))) ? false : $___mysqli_res);\n"}, "startLine": 33}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/csrf/source/medium.php"}, "contextRegion": {"snippet": {"text": "\n\t((is_null($___mysqli_res = mysqli_close($GLOBALS[\"___mysqli_ston\"]))) ? false : $___mysqli_res);\n}\n\n"}, "endLine": 35, "startLine": 32}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "a4888879b9d45856", "scanFileHash": "3797bc11bef2af6e"}, "ruleId": "TypeDoesNotContainNull", "ruleIndex": 1}, {"message": {"markdown": "", "text": "Unsafe shell_exec."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t\t$cmd = shell_exec( 'ping  ' . $target );\n"}, "startLine": 26}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/exec/source/high.php"}, "contextRegion": {"snippet": {"text": "\t\t// Windows\n\t\t$cmd = shell_exec( 'ping  ' . $target );\n\t}\n\telse {\n"}, "endLine": 28, "startLine": 25}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "b96443b5b30f6e55", "scanFileHash": "d527bab2ab2df405"}, "ruleId": "ForbiddenCode", "ruleIndex": 2}, {"message": {"markdown": "", "text": "Unsafe shell_exec."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t\t$cmd = shell_exec( 'ping  -c 4 ' . $target );\n"}, "startLine": 30}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/exec/source/high.php"}, "contextRegion": {"snippet": {"text": "\t\t// *nix\n\t\t$cmd = shell_exec( 'ping  -c 4 ' . $target );\n\t}\n\n"}, "endLine": 32, "startLine": 29}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "037053f59a8dd53a", "scanFileHash": "d527bab2ab2df405"}, "ruleId": "ForbiddenCode", "ruleIndex": 2}, {"message": {"markdown": "", "text": "Unsafe shell_exec."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t\t\t$cmd = shell_exec( 'ping  ' . $target );\n"}, "startLine": 22}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/exec/source/impossible.php"}, "contextRegion": {"snippet": {"text": "\t\t\t// Windows\n\t\t\t$cmd = shell_exec( 'ping  ' . $target );\n\t\t}\n\t\telse {\n"}, "endLine": 24, "startLine": 21}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "b96443b5b30f6e55", "scanFileHash": "89a68473da7aad14"}, "ruleId": "ForbiddenCode", "ruleIndex": 2}, {"message": {"markdown": "", "text": "Unsafe shell_exec."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t\t\t$cmd = shell_exec( 'ping  -c 4 ' . $target );\n"}, "startLine": 26}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/exec/source/impossible.php"}, "contextRegion": {"snippet": {"text": "\t\t\t// *nix\n\t\t\t$cmd = shell_exec( 'ping  -c 4 ' . $target );\n\t\t}\n\n"}, "endLine": 28, "startLine": 25}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "037053f59a8dd53a", "scanFileHash": "89a68473da7aad14"}, "ruleId": "ForbiddenCode", "ruleIndex": 2}, {"message": {"markdown": "", "text": "Unsafe shell_exec."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t\t$cmd = shell_exec( 'ping  ' . $target );\n"}, "startLine": 10}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/exec/source/low.php"}, "contextRegion": {"snippet": {"text": "\t\t// Windows\n\t\t$cmd = shell_exec( 'ping  ' . $target );\n\t}\n\telse {\n"}, "endLine": 12, "startLine": 9}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "b96443b5b30f6e55", "scanFileHash": "5d20f5b82084c276"}, "ruleId": "ForbiddenCode", "ruleIndex": 2}, {"message": {"markdown": "", "text": "Unsafe shell_exec."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t\t$cmd = shell_exec( 'ping  -c 4 ' . $target );\n"}, "startLine": 14}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/exec/source/low.php"}, "contextRegion": {"snippet": {"text": "\t\t// *nix\n\t\t$cmd = shell_exec( 'ping  -c 4 ' . $target );\n\t}\n\n"}, "endLine": 16, "startLine": 13}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "037053f59a8dd53a", "scanFileHash": "5d20f5b82084c276"}, "ruleId": "ForbiddenCode", "ruleIndex": 2}, {"message": {"markdown": "", "text": "Unsafe shell_exec."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t\t$cmd = shell_exec( 'ping  ' . $target );\n"}, "startLine": 19}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/exec/source/medium.php"}, "contextRegion": {"snippet": {"text": "\t\t// Windows\n\t\t$cmd = shell_exec( 'ping  ' . $target );\n\t}\n\telse {\n"}, "endLine": 21, "startLine": 18}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "b96443b5b30f6e55", "scanFileHash": "98017c25353e0245"}, "ruleId": "ForbiddenCode", "ruleIndex": 2}, {"message": {"markdown": "", "text": "Unsafe shell_exec."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t\t$cmd = shell_exec( 'ping  -c 4 ' . $target );\n"}, "startLine": 23}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/exec/source/medium.php"}, "contextRegion": {"snippet": {"text": "\t\t// *nix\n\t\t$cmd = shell_exec( 'ping  -c 4 ' . $target );\n\t}\n\n"}, "endLine": 25, "startLine": 22}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "037053f59a8dd53a", "scanFileHash": "98017c25353e0245"}, "ruleId": "ForbiddenCode", "ruleIndex": 2}, {"message": {"markdown": "", "text": "Cannot resolve types for $___mysqli_res - bool does not contain null."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t\t\t((is_null($___mysqli_res = mysqli_close($GLOBALS[\"___mysqli_ston\"]))) ? false : $___mysqli_res);\t\t\n"}, "startLine": 23}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/sqli/source/high.php"}, "contextRegion": {"snippet": {"text": "\n\t\t\t((is_null($___mysqli_res = mysqli_close($GLOBALS[\"___mysqli_ston\"]))) ? false : $___mysqli_res);\t\t\n\t\t\tbreak;\n\t\tcase SQLITE:\n"}, "endLine": 25, "startLine": 22}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "a4888879b9d45856", "scanFileHash": "2dd24b2f727ebcfd"}, "ruleId": "TypeDoesNotContainNull", "ruleIndex": 1}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_error expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t\t\t$result = mysqli_query($GLOBALS[\"___mysqli_ston\"],  $query ) or die( '<pre>' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );\n"}, "startLine": 11}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/sqli/source/low.php"}, "contextRegion": {"snippet": {"text": "\t\t\t$query  = \"SELECT first_name, last_name FROM users WHERE user_id = '$id';\";\n\t\t\t$result = mysqli_query($GLOBALS[\"___mysqli_ston\"],  $query ) or die( '<pre>' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );\n\n\t\t\t// Get results\n"}, "endLine": 13, "startLine": 10}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "97831a3e1dfedafc", "scanFileHash": "f920be89c6dbe9c8"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_error expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "$result = mysqli_query($GLOBALS[\"___mysqli_ston\"],  $query ) or die( '<pre>' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );\n"}, "startLine": 55}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/sqli/source/medium.php"}, "contextRegion": {"snippet": {"text": "$query  = \"SELECT COUNT(*) FROM users;\";\n$result = mysqli_query($GLOBALS[\"___mysqli_ston\"],  $query ) or die( '<pre>' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );\n$number_of_rows = mysqli_fetch_row( $result )[0];\n\n"}, "endLine": 57, "startLine": 54}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "97831a3e1dfedafc", "scanFileHash": "9cce3a12d97fa3e4"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_error expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t\t$result = mysqli_query($GLOBALS[\"___mysqli_ston\"],  $query ) or die( '<pre>' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );\n"}, "startLine": 64}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/sqli_blind/index.php"}, "contextRegion": {"snippet": {"text": "\t\t$query  = \"SELECT COUNT(*) FROM users;\";\n\t\t$result = mysqli_query($GLOBALS[\"___mysqli_ston\"],  $query ) or die( '<pre>' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );\n\t\t$num    = mysqli_fetch_row( $result )[0];\n\t\t$i      = 0;\n"}, "endLine": 66, "startLine": 63}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "97831a3e1dfedafc", "scanFileHash": "3fb045b298959385"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Cannot resolve types for $___mysqli_res - bool does not contain null."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t\t\t((is_null($___mysqli_res = mysqli_close($GLOBALS[\"___mysqli_ston\"]))) ? false : $___mysqli_res);\n"}, "startLine": 21}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/sqli_blind/source/high.php"}, "contextRegion": {"snippet": {"text": "\n\t\t\t((is_null($___mysqli_res = mysqli_close($GLOBALS[\"___mysqli_ston\"]))) ? false : $___mysqli_res);\n\t\t\tbreak;\n\t\tcase SQLITE:\n"}, "endLine": 23, "startLine": 20}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "a4888879b9d45856", "scanFileHash": "bcb3a8c08e8ca177"}, "ruleId": "TypeDoesNotContainNull", "ruleIndex": 1}, {"message": {"markdown": "", "text": "Cannot resolve types for $___mysqli_res - bool does not contain null."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t\t\t((is_null($___mysqli_res = mysqli_close($GLOBALS[\"___mysqli_ston\"]))) ? false : $___mysqli_res);\n"}, "startLine": 19}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/sqli_blind/source/low.php"}, "contextRegion": {"snippet": {"text": "\t\t\t}\n\t\t\t((is_null($___mysqli_res = mysqli_close($GLOBALS[\"___mysqli_ston\"]))) ? false : $___mysqli_res);\n\t\t\tbreak;\n\t\tcase SQLITE:\n"}, "endLine": 21, "startLine": 18}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "a4888879b9d45856", "scanFileHash": "8e3bd3d08a9c9e73"}, "ruleId": "TypeDoesNotContainNull", "ruleIndex": 1}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_real_escape_string expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t\t\t$id = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $id ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n"}, "startLine": 10}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/sqli_blind/source/medium.php"}, "contextRegion": {"snippet": {"text": "\t\tcase MYSQL:\n\t\t\t$id = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $id ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n\n\t\t\t// Check database\n"}, "endLine": 12, "startLine": 9}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "e8d51e5e5c888a8a", "scanFileHash": "a9eb112f1da464f9"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Cannot resolve types for $___mysqli_res - bool does not contain null."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t\t\t((is_null($___mysqli_res = mysqli_close($GLOBALS[\"___mysqli_ston\"]))) ? false : $___mysqli_res);\n"}, "startLine": 22}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/sqli_blind/source/medium.php"}, "contextRegion": {"snippet": {"text": "\t\t\t\n\t\t\t((is_null($___mysqli_res = mysqli_close($GLOBALS[\"___mysqli_ston\"]))) ? false : $___mysqli_res);\n\t\t\tbreak;\n\t\tcase SQLITE:\n"}, "endLine": 24, "startLine": 21}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "a4888879b9d45856", "scanFileHash": "a9eb112f1da464f9"}, "ruleId": "TypeDoesNotContainNull", "ruleIndex": 1}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_error expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$result = mysqli_query($GLOBALS[\"___mysqli_ston\"],  $query ) or die( '<pre>' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );\n"}, "startLine": 18}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/xss_s/index.php"}, "contextRegion": {"snippet": {"text": "\t$query  = \"TRUNCATE guestbook;\";\n\t$result = mysqli_query($GLOBALS[\"___mysqli_ston\"],  $query ) or die( '<pre>' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );\n}\n\n"}, "endLine": 20, "startLine": 17}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "97831a3e1dfedafc", "scanFileHash": "242da9659831bcd4"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_real_escape_string expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$message = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $message ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n"}, "startLine": 10}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/xss_s/source/high.php"}, "contextRegion": {"snippet": {"text": "\t$message = strip_tags( addslashes( $message ) );\n\t$message = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $message ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n\t$message = htmlspecialchars( $message );\n\n"}, "endLine": 12, "startLine": 9}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "d311c35bc24a977e", "scanFileHash": "e422f63c1a24b3a6"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_real_escape_string expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$name = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $name ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n"}, "startLine": 15}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/xss_s/source/high.php"}, "contextRegion": {"snippet": {"text": "\t$name = preg_replace( '/<(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i', '', $name );\n\t$name = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $name ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n\n\t// Update database\n"}, "endLine": 17, "startLine": 14}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "ecb17db14bb6a3f0", "scanFileHash": "e422f63c1a24b3a6"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_error expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$result = mysqli_query($GLOBALS[\"___mysqli_ston\"],  $query ) or die( '<pre>' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );\n"}, "startLine": 19}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/xss_s/source/high.php"}, "contextRegion": {"snippet": {"text": "\t$query  = \"INSERT INTO guestbook ( comment, name ) VALUES ( '$message', '$name' );\";\n\t$result = mysqli_query($GLOBALS[\"___mysqli_ston\"],  $query ) or die( '<pre>' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );\n\n\t//mysql_close();\n"}, "endLine": 21, "startLine": 18}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "97831a3e1dfedafc", "scanFileHash": "e422f63c1a24b3a6"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_real_escape_string expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$message = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $message ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n"}, "startLine": 13}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/xss_s/source/impossible.php"}, "contextRegion": {"snippet": {"text": "\t$message = stripslashes( $message );\n\t$message = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $message ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n\t$message = htmlspecialchars( $message );\n\n"}, "endLine": 15, "startLine": 12}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "d311c35bc24a977e", "scanFileHash": "c1f5aaee4793d1f4"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_real_escape_string expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$name = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $name ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n"}, "startLine": 18}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/xss_s/source/impossible.php"}, "contextRegion": {"snippet": {"text": "\t$name = stripslashes( $name );\n\t$name = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $name ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n\t$name = htmlspecialchars( $name );\n\n"}, "endLine": 20, "startLine": 17}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "ecb17db14bb6a3f0", "scanFileHash": "c1f5aaee4793d1f4"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_real_escape_string expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$message = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $message ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n"}, "startLine": 10}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/xss_s/source/low.php"}, "contextRegion": {"snippet": {"text": "\t$message = stripslashes( $message );\n\t$message = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $message ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n\n\t// Sanitize name input\n"}, "endLine": 12, "startLine": 9}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "d311c35bc24a977e", "scanFileHash": "db9911cbf0fb5705"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_real_escape_string expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$name = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $name ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n"}, "startLine": 13}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/xss_s/source/low.php"}, "contextRegion": {"snippet": {"text": "\t// Sanitize name input\n\t$name = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $name ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n\n\t// Update database\n"}, "endLine": 15, "startLine": 12}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "ecb17db14bb6a3f0", "scanFileHash": "db9911cbf0fb5705"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_error expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$result = mysqli_query($GLOBALS[\"___mysqli_ston\"],  $query ) or die( '<pre>' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );\n"}, "startLine": 17}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/xss_s/source/low.php"}, "contextRegion": {"snippet": {"text": "\t$query  = \"INSERT INTO guestbook ( comment, name ) VALUES ( '$message', '$name' );\";\n\t$result = mysqli_query($GLOBALS[\"___mysqli_ston\"],  $query ) or die( '<pre>' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );\n\n\t//mysql_close();\n"}, "endLine": 19, "startLine": 16}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "97831a3e1dfedafc", "scanFileHash": "db9911cbf0fb5705"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_real_escape_string expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$message = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $message ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n"}, "startLine": 10}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/xss_s/source/medium.php"}, "contextRegion": {"snippet": {"text": "\t$message = strip_tags( addslashes( $message ) );\n\t$message = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $message ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n\t$message = htmlspecialchars( $message );\n\n"}, "endLine": 12, "startLine": 9}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "d311c35bc24a977e", "scanFileHash": "c7108de1749d7759"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_real_escape_string expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$name = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $name ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n"}, "startLine": 15}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/xss_s/source/medium.php"}, "contextRegion": {"snippet": {"text": "\t$name = str_replace( '<script>', '', $name );\n\t$name = ((isset($GLOBALS[\"___mysqli_ston\"]) && is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"],  $name ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\"));\n\n\t// Update database\n"}, "endLine": 17, "startLine": 14}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "ecb17db14bb6a3f0", "scanFileHash": "c7108de1749d7759"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Argument 1 of mysqli_error expects mysqli, parent type object provided."}, "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$result = mysqli_query($GLOBALS[\"___mysqli_ston\"],  $query ) or die( '<pre>' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );\n"}, "startLine": 19}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/xss_s/source/medium.php"}, "contextRegion": {"snippet": {"text": "\t$query  = \"INSERT INTO guestbook ( comment, name ) VALUES ( '$message', '$name' );\";\n\t$result = mysqli_query($GLOBALS[\"___mysqli_ston\"],  $query ) or die( '<pre>' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '</pre>' );\n\n\t//mysql_close();\n"}, "endLine": 21, "startLine": 18}}}], "properties": {"issue_confidence": "MEDIUM", "issue_severity": "MEDIUM", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "97831a3e1dfedafc", "scanFileHash": "c7108de1749d7759"}, "ruleId": "ArgumentTypeCoercion", "ruleIndex": 0}], "automationDetails": {"description": {"text": "Static Analysis Security Test results using @ShiftLeft/sast-scan"}, "guid": "f4f64baf-2ed5-480f-8143-b11c61a26dc4"}, "versionControlProvenance": [{"branch": "", "repositoryUri": "", "revisionId": ""}]}
{"tool": {"driver": {"name": "PHP Security Analysis", "rules": [{"id": "244", "help": {"text": "Detected tainted SQL: $_GET['username']\\n$user\\nconcat\\n$query\\ncall to mysqli_query.", "markdown": "Detected tainted SQL: $_GET['username']\\n$user\\nconcat\\n$query\\ncall to mysqli_query."}, "name": "TaintedSql", "properties": {"tags": ["Scan"], "precision": "high"}, "defaultConfiguration": {"level": "error"}, "fullDescription": {"text": "Detected tainted SQL: $_GET['username']\\n$user\\nconcat\\n$query\\ncall to mysqli_query."}, "helpUri": "https://psalm.dev/244", "shortDescription": {"text": "Detected tainted SQL: $_GET['username']\\n$user\\nconcat\\n$query\\ncall to mysqli_query."}}, {"id": "245", "help": {"text": "Detected tainted HTML: $_GET['callback']\\n$callback\\nconcat\\nconcat\\nconcat\\ncall to echo.", "markdown": "Detected tainted HTML: $_GET['callback']\\n$callback\\nconcat\\nconcat\\nconcat\\ncall to echo."}, "name": "TaintedHtml", "properties": {"tags": ["Scan"], "precision": "high"}, "defaultConfiguration": {"level": "error"}, "fullDescription": {"text": "Detected tainted HTML: $_GET['callback']\\n$callback\\nconcat\\nconcat\\nconcat\\ncall to echo."}, "helpUri": "https://psalm.dev/245", "shortDescription": {"text": "Detected tainted HTML: $_GET['callback']\\n$callback\\nconcat\\nconcat\\nconcat\\ncall to echo."}}, {"id": "274", "help": {"text": "Detected tainted text with possible quotes: $_GET['callback']\\n$callback\\nconcat\\nconcat\\nconcat\\ncall to echo.", "markdown": "Detected tainted text with possible quotes: $_GET['callback']\\n$callback\\nconcat\\nconcat\\nconcat\\ncall to echo."}, "name": "TaintedTextWithQuotes", "properties": {"tags": ["Scan"], "precision": "high"}, "defaultConfiguration": {"level": "error"}, "fullDescription": {"text": "Detected tainted text with possible quotes: $_GET['callback']\\n$callback\\nconcat\\nconcat\\nconcat\\ncall to echo."}, "helpUri": "https://psalm.dev/274", "shortDescription": {"text": "Detected tainted text with possible quotes: $_GET['callback']\\n$callback\\nconcat\\nconcat\\nconcat\\ncall to echo."}}, {"id": "246", "help": {"text": "Detected tainted shell code: $_REQUEST['ip']\\ncall to trim\\ntrim#1\\n$target\\ncall to str_replace\\nstr_replace#3\\n$target\\nconcat\\ncall to shell_exec.", "markdown": "Detected tainted shell code: $_REQUEST['ip']\\ncall to trim\\ntrim#1\\n$target\\ncall to str_replace\\nstr_replace#3\\n$target\\nconcat\\ncall to shell_exec."}, "name": "TaintedShell", "properties": {"tags": ["Scan"], "precision": "high"}, "defaultConfiguration": {"level": "error"}, "fullDescription": {"text": "Detected tainted shell code: $_REQUEST['ip']\\ncall to trim\\ntrim#1\\n$target\\ncall to str_replace\\nstr_replace#3\\n$target\\nconcat\\ncall to shell_exec."}, "helpUri": "https://psalm.dev/246", "shortDescription": {"text": "Detected tainted shell code: $_REQUEST['ip']\\ncall to trim\\ntrim#1\\n$target\\ncall to str_replace\\nstr_replace#3\\n$target\\nconcat\\ncall to shell_exec."}}, {"id": "257", "help": {"text": "Detected tainted cookie: $_POST['id']\\ncall to setcookie.", "markdown": "Detected tainted cookie: $_POST['id']\\ncall to setcookie."}, "name": "TaintedCookie", "properties": {"tags": ["Scan"], "precision": "high"}, "defaultConfiguration": {"level": "error"}, "fullDescription": {"text": "Detected tainted cookie: $_POST['id']\\ncall to setcookie."}, "helpUri": "https://psalm.dev/257", "shortDescription": {"text": "Detected tainted cookie: $_POST['id']\\ncall to setcookie."}}, {"id": "255", "help": {"text": "Detected tainted file handling: $_GET['id']\\n$id\\nconcat\\nconcat\\ncall to file_get_contents.", "markdown": "Detected tainted file handling: $_GET['id']\\n$id\\nconcat\\nconcat\\ncall to file_get_contents."}, "name": "TaintedFile", "properties": {"tags": ["Scan"], "precision": "high"}, "defaultConfiguration": {"level": "error"}, "fullDescription": {"text": "Detected tainted file handling: $_GET['id']\\n$id\\nconcat\\nconcat\\ncall to file_get_contents."}, "helpUri": "https://psalm.dev/255", "shortDescription": {"text": "Detected tainted file handling: $_GET['id']\\n$id\\nconcat\\nconcat\\ncall to file_get_contents."}}], "version": "1.0.0-scan", "fullName": "PHP Security Analysis"}}, "conversion": {"tool": {"driver": {"name": "@ShiftLeft/sast-scan"}}, "invocation": {"arguments": ["/opt/phpsast/vendor/bin/psalm", "--report-show-info=false", "--show-snippet=true", "--taint-analysis", "-m", "--no-progress", "--no-file-cache", "--no-suggestions", "--no-cache", "--root=/github/workspace", "--report=reports/taint-php-report.json"], "executionSuccessful": true, "commandLine": "/opt/phpsast/vendor/bin/psalm --report-show-info=false --show-snippet=true --taint-analysis -m --no-progress --no-file-cache --no-suggestions --no-cache --root=/github/workspace --report=reports/taint-php-report.json", "endTimeUtc": "2021-11-17T00:36:48Z", "workingDirectory": {"uri": "file:///github/workspace"}}}, "invocations": [{"executionSuccessful": true, "endTimeUtc": "2021-11-17T00:36:48Z", "workingDirectory": {"uri": "file:///github/workspace"}}], "properties": {"metrics": {"total": 23, "critical": 23, "high": 0, "medium": 0, "low": 0}}, "results": [{"message": {"markdown": "", "text": "Detected tainted SQL: $_GET['username']\\n$user\\nconcat\\n$query\\ncall to mysqli_query."}, "level": "error", "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$user = $_GET[ 'username' ];\n"}, "startLine": 5}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/brute/source/low.php"}, "contextRegion": {"snippet": {"text": "\t// Get username\n\t$user = $_GET[ 'username' ];\n"}, "endLine": 5, "startLine": 4}}}], "properties": {"issue_confidence": "HIGH", "issue_severity": "CRITICAL", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "239c953e46422198", "scanFileHash": "f36da3753611a347"}, "ruleId": "244", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Detected tainted HTML: $_GET['callback']\\n$callback\\nconcat\\nconcat\\nconcat\\ncall to echo."}, "level": "error", "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$callback = $_GET['callback'];\n"}, "startLine": 5}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/csp/source/jsonp.php"}, "contextRegion": {"snippet": {"text": "if (array_key_exists (\"callback\", $_GET)) {\n\t$callback = $_GET['callback'];\n"}, "endLine": 5, "startLine": 4}}}], "properties": {"issue_confidence": "HIGH", "issue_severity": "CRITICAL", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "0876ba43b076148e", "scanFileHash": "9151c71b00b25a12"}, "ruleId": "245", "ruleIndex": 1}, {"message": {"markdown": "", "text": "Detected tainted text with possible quotes: $_GET['callback']\\n$callback\\nconcat\\nconcat\\nconcat\\ncall to echo."}, "level": "error", "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$callback = $_GET['callback'];\n"}, "startLine": 5}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/csp/source/jsonp.php"}, "contextRegion": {"snippet": {"text": "if (array_key_exists (\"callback\", $_GET)) {\n\t$callback = $_GET['callback'];\n"}, "endLine": 5, "startLine": 4}}}], "properties": {"issue_confidence": "HIGH", "issue_severity": "CRITICAL", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "0876ba43b076148e", "scanFileHash": "9151c71b00b25a12"}, "ruleId": "274", "ruleIndex": 2}, {"message": {"markdown": "", "text": "Detected tainted shell code: $_REQUEST['ip']\\ncall to trim\\ntrim#1\\n$target\\ncall to str_replace\\nstr_replace#3\\n$target\\nconcat\\ncall to shell_exec."}, "level": "error", "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$target = trim($_REQUEST[ 'ip' ]);\n"}, "startLine": 5}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/exec/source/high.php"}, "contextRegion": {"snippet": {"text": "\t// Get input\n\t$target = trim($_REQUEST[ 'ip' ]);\n"}, "endLine": 5, "startLine": 4}}}], "properties": {"issue_confidence": "HIGH", "issue_severity": "CRITICAL", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "c5674f671fa62ccf", "scanFileHash": "d527bab2ab2df405"}, "ruleId": "246", "ruleIndex": 3}, {"message": {"markdown": "", "text": "Detected tainted shell code: $_REQUEST['ip']\\ncall to trim\\ntrim#1\\n$target\\ncall to str_replace\\nstr_replace#3\\n$target\\nconcat\\ncall to shell_exec."}, "level": "error", "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$target = trim($_REQUEST[ 'ip' ]);\n"}, "startLine": 5}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/exec/source/high.php"}, "contextRegion": {"snippet": {"text": "\t// Get input\n\t$target = trim($_REQUEST[ 'ip' ]);\n"}, "endLine": 5, "startLine": 4}}}], "properties": {"issue_confidence": "HIGH", "issue_severity": "CRITICAL", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "c5674f671fa62ccf", "scanFileHash": "d527bab2ab2df405"}, "ruleId": "246", "ruleIndex": 3}, {"message": {"markdown": "", "text": "Detected tainted shell code: $_REQUEST['ip']\\n$target\\ncall to stripslashes\\nstripslashes#1\\n$target\\ncall to explode\\nexplode#2\\n$octet\\n$octet[3]\\nconcat\\n$target\\nconcat\\ncall to shell_exec."}, "level": "error", "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$target = $_REQUEST[ 'ip' ];\n"}, "startLine": 8}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/exec/source/impossible.php"}, "contextRegion": {"snippet": {"text": "\t// Get input\n\t$target = $_REQUEST[ 'ip' ];\n"}, "endLine": 8, "startLine": 7}}}], "properties": {"issue_confidence": "HIGH", "issue_severity": "CRITICAL", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "30895ad1b09a591f", "scanFileHash": "89a68473da7aad14"}, "ruleId": "246", "ruleIndex": 3}, {"message": {"markdown": "", "text": "Detected tainted shell code: $_REQUEST['ip']\\n$target\\ncall to stripslashes\\nstripslashes#1\\n$target\\ncall to explode\\nexplode#2\\n$octet\\n$octet[3]\\nconcat\\n$target\\nconcat\\ncall to shell_exec."}, "level": "error", "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$target = $_REQUEST[ 'ip' ];\n"}, "startLine": 8}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/exec/source/impossible.php"}, "contextRegion": {"snippet": {"text": "\t// Get input\n\t$target = $_REQUEST[ 'ip' ];\n"}, "endLine": 8, "startLine": 7}}}], "properties": {"issue_confidence": "HIGH", "issue_severity": "CRITICAL", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "30895ad1b09a591f", "scanFileHash": "89a68473da7aad14"}, "ruleId": "246", "ruleIndex": 3}, {"message": {"markdown": "", "text": "Detected tainted shell code: $_REQUEST['ip']\\n$target\\nconcat\\ncall to shell_exec."}, "level": "error", "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$target = $_REQUEST[ 'ip' ];\n"}, "startLine": 5}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/exec/source/low.php"}, "contextRegion": {"snippet": {"text": "\t// Get input\n\t$target = $_REQUEST[ 'ip' ];\n"}, "endLine": 5, "startLine": 4}}}], "properties": {"issue_confidence": "HIGH", "issue_severity": "CRITICAL", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "30895ad1b09a591f", "scanFileHash": "5d20f5b82084c276"}, "ruleId": "246", "ruleIndex": 3}, {"message": {"markdown": "", "text": "Detected tainted shell code: $_REQUEST['ip']\\n$target\\nconcat\\ncall to shell_exec."}, "level": "error", "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$target = $_REQUEST[ 'ip' ];\n"}, "startLine": 5}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/exec/source/low.php"}, "contextRegion": {"snippet": {"text": "\t// Get input\n\t$target = $_REQUEST[ 'ip' ];\n"}, "endLine": 5, "startLine": 4}}}], "properties": {"issue_confidence": "HIGH", "issue_severity": "CRITICAL", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "30895ad1b09a591f", "scanFileHash": "5d20f5b82084c276"}, "ruleId": "246", "ruleIndex": 3}, {"message": {"markdown": "", "text": "Detected tainted shell code: $_REQUEST['ip']\\n$target\\ncall to str_replace\\nstr_replace#3\\n$target\\nconcat\\ncall to shell_exec."}, "level": "error", "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$target = $_REQUEST[ 'ip' ];\n"}, "startLine": 5}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/exec/source/medium.php"}, "contextRegion": {"snippet": {"text": "\t// Get input\n\t$target = $_REQUEST[ 'ip' ];\n"}, "endLine": 5, "startLine": 4}}}], "properties": {"issue_confidence": "HIGH", "issue_severity": "CRITICAL", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "30895ad1b09a591f", "scanFileHash": "98017c25353e0245"}, "ruleId": "246", "ruleIndex": 3}, {"message": {"markdown": "", "text": "Detected tainted shell code: $_REQUEST['ip']\\n$target\\ncall to str_replace\\nstr_replace#3\\n$target\\nconcat\\ncall to shell_exec."}, "level": "error", "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$target = $_REQUEST[ 'ip' ];\n"}, "startLine": 5}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/exec/source/medium.php"}, "contextRegion": {"snippet": {"text": "\t// Get input\n\t$target = $_REQUEST[ 'ip' ];\n"}, "endLine": 5, "startLine": 4}}}], "properties": {"issue_confidence": "HIGH", "issue_severity": "CRITICAL", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "30895ad1b09a591f", "scanFileHash": "98017c25353e0245"}, "ruleId": "246", "ruleIndex": 3}, {"message": {"markdown": "", "text": "Detected tainted SQL: $_REQUEST['id']\\n$id\\nconcat\\n$query\\ncall to mysqli_query."}, "level": "error", "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$id = $_REQUEST[ 'id' ];\n"}, "startLine": 5}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/sqli/source/low.php"}, "contextRegion": {"snippet": {"text": "\t// Get input\n\t$id = $_REQUEST[ 'id' ];\n"}, "endLine": 5, "startLine": 4}}}], "properties": {"issue_confidence": "HIGH", "issue_severity": "CRITICAL", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "e3c8c652896cdacd", "scanFileHash": "f920be89c6dbe9c8"}, "ruleId": "244", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Detected tainted cookie: $_POST['id']\\ncall to setcookie."}, "level": "error", "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\tsetcookie( 'id', $_POST[ 'id' ]);\n"}, "startLine": 12}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/sqli_blind/cookie-input.php"}, "contextRegion": {"snippet": {"text": "if( isset( $_POST[ 'id' ] ) ) {\n\tsetcookie( 'id', $_POST[ 'id' ]);\n"}, "endLine": 12, "startLine": 11}}}], "properties": {"issue_confidence": "HIGH", "issue_severity": "CRITICAL", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "308f1db6f3146695", "scanFileHash": "860742fcdbb822a4"}, "ruleId": "257", "ruleIndex": 4}, {"message": {"markdown": "", "text": "Detected tainted SQL: $_COOKIE['id']\\n$id\\nconcat\\n$query\\ncall to mysqli_query."}, "level": "error", "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$id = $_COOKIE[ 'id' ];\n"}, "startLine": 5}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/sqli_blind/source/high.php"}, "contextRegion": {"snippet": {"text": "\t// Get input\n\t$id = $_COOKIE[ 'id' ];\n"}, "endLine": 5, "startLine": 4}}}], "properties": {"issue_confidence": "HIGH", "issue_severity": "CRITICAL", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "910a7386a739e254", "scanFileHash": "bcb3a8c08e8ca177"}, "ruleId": "244", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Detected tainted SQL: $_GET['id']\\n$id\\nconcat\\n$query\\ncall to mysqli_query."}, "level": "error", "locations": [{"physicalLocation": {"region": {"snippet": {"text": "\t$id = $_GET[ 'id' ];\n"}, "startLine": 5}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/sqli_blind/source/low.php"}, "contextRegion": {"snippet": {"text": "\t// Get input\n\t$id = $_GET[ 'id' ];\n"}, "endLine": 5, "startLine": 4}}}], "properties": {"issue_confidence": "HIGH", "issue_severity": "CRITICAL", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "36e0a4ad4bbcd04c", "scanFileHash": "8e3bd3d08a9c9e73"}, "ruleId": "244", "ruleIndex": 0}, {"message": {"markdown": "", "text": "Detected tainted file handling: $_GET['id']\\n$id\\nconcat\\nconcat\\ncall to file_get_contents."}, "level": "error", "locations": [{"physicalLocation": {"region": {"snippet": {"text": "$id       = $_GET[ 'id' ];\n"}, "startLine": 11}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/view_help.php"}, "contextRegion": {"snippet": {"text": "\n$id       = $_GET[ 'id' ];\n"}, "endLine": 11, "startLine": 10}}}], "properties": {"issue_confidence": "HIGH", "issue_severity": "CRITICAL", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "5929aa0b212a8741", "scanFileHash": "e77b9b28e56a6144"}, "ruleId": "255", "ruleIndex": 5}, {"message": {"markdown": "", "text": "Detected tainted file handling: $_GET['locale']\\n$locale\\nconcat\\nconcat\\ncall to file_get_contents."}, "level": "error", "locations": [{"physicalLocation": {"region": {"snippet": {"text": "$locale = $_GET[ 'locale' ];\n"}, "startLine": 13}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/view_help.php"}, "contextRegion": {"snippet": {"text": "$security = $_GET[ 'security' ];\n$locale = $_GET[ 'locale' ];\n"}, "endLine": 13, "startLine": 12}}}], "properties": {"issue_confidence": "HIGH", "issue_severity": "CRITICAL", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "05793867e50cef3f", "scanFileHash": "e77b9b28e56a6144"}, "ruleId": "255", "ruleIndex": 5}, {"message": {"markdown": "", "text": "Detected tainted file handling: $_GET['security']\\n$security\\nconcat\\nconcat\\ncall to file_get_contents."}, "level": "error", "locations": [{"physicalLocation": {"region": {"snippet": {"text": "$security = $_GET[ 'security' ];\n"}, "startLine": 12}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/view_source.php"}, "contextRegion": {"snippet": {"text": "$id       = $_GET[ 'id' ];\n$security = $_GET[ 'security' ];\n"}, "endLine": 12, "startLine": 11}}}], "properties": {"issue_confidence": "HIGH", "issue_severity": "CRITICAL", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "485e280b9e24f678", "scanFileHash": "e81291096c36c4a6"}, "ruleId": "255", "ruleIndex": 5}, {"message": {"markdown": "", "text": "Detected tainted file handling: $_GET['security']\\n$security\\nconcat\\nconcat\\ncall to file_get_contents."}, "level": "error", "locations": [{"physicalLocation": {"region": {"snippet": {"text": "$security = $_GET[ 'security' ];\n"}, "startLine": 12}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/view_source.php"}, "contextRegion": {"snippet": {"text": "$id       = $_GET[ 'id' ];\n$security = $_GET[ 'security' ];\n"}, "endLine": 12, "startLine": 11}}}], "properties": {"issue_confidence": "HIGH", "issue_severity": "CRITICAL", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "485e280b9e24f678", "scanFileHash": "e81291096c36c4a6"}, "ruleId": "255", "ruleIndex": 5}, {"message": {"markdown": "", "text": "Detected tainted file handling: $_GET['id']\\n$id\\nconcat\\ncall to file_get_contents."}, "level": "error", "locations": [{"physicalLocation": {"region": {"snippet": {"text": "$id = $_GET[ 'id' ];\n"}, "startLine": 11}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/view_source_all.php"}, "contextRegion": {"snippet": {"text": "\n$id = $_GET[ 'id' ];\n"}, "endLine": 11, "startLine": 10}}}], "properties": {"issue_confidence": "HIGH", "issue_severity": "CRITICAL", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "36e0a4ad4bbcd04c", "scanFileHash": "e64b5ad7206a680e"}, "ruleId": "255", "ruleIndex": 5}, {"message": {"markdown": "", "text": "Detected tainted file handling: $_GET['id']\\n$id\\nconcat\\ncall to file_get_contents."}, "level": "error", "locations": [{"physicalLocation": {"region": {"snippet": {"text": "$id = $_GET[ 'id' ];\n"}, "startLine": 11}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/view_source_all.php"}, "contextRegion": {"snippet": {"text": "\n$id = $_GET[ 'id' ];\n"}, "endLine": 11, "startLine": 10}}}], "properties": {"issue_confidence": "HIGH", "issue_severity": "CRITICAL", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "36e0a4ad4bbcd04c", "scanFileHash": "e64b5ad7206a680e"}, "ruleId": "255", "ruleIndex": 5}, {"message": {"markdown": "", "text": "Detected tainted file handling: $_GET['id']\\n$id\\nconcat\\ncall to file_get_contents."}, "level": "error", "locations": [{"physicalLocation": {"region": {"snippet": {"text": "$id = $_GET[ 'id' ];\n"}, "startLine": 11}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/view_source_all.php"}, "contextRegion": {"snippet": {"text": "\n$id = $_GET[ 'id' ];\n"}, "endLine": 11, "startLine": 10}}}], "properties": {"issue_confidence": "HIGH", "issue_severity": "CRITICAL", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "36e0a4ad4bbcd04c", "scanFileHash": "e64b5ad7206a680e"}, "ruleId": "255", "ruleIndex": 5}, {"message": {"markdown": "", "text": "Detected tainted file handling: $_GET['id']\\n$id\\nconcat\\ncall to file_get_contents."}, "level": "error", "locations": [{"physicalLocation": {"region": {"snippet": {"text": "$id = $_GET[ 'id' ];\n"}, "startLine": 11}, "artifactLocation": {"uri": "file:///github/workspace/vulnerabilities/view_source_all.php"}, "contextRegion": {"snippet": {"text": "\n$id = $_GET[ 'id' ];\n"}, "endLine": 11, "startLine": 10}}}], "properties": {"issue_confidence": "HIGH", "issue_severity": "CRITICAL", "issue_tags": {}}, "baselineState": "new", "partialFingerprints": {"scanPrimaryLocationHash": "36e0a4ad4bbcd04c", "scanFileHash": "e64b5ad7206a680e"}, "ruleId": "255", "ruleIndex": 5}], "automationDetails": {"description": {"text": "Static Analysis Security Test results using @ShiftLeft/sast-scan"}, "guid": "489203d8-b9ea-426f-9b71-859f3b0991a8"}, "versionControlProvenance": [{"branch": "", "repositoryUri": "", "revisionId": ""}]}
